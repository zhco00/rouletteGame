(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();const r={slices:[{degrees:25,color:"#ff0000",text:"GAME OVER"},{degrees:45,color:"#fcda6a",text:"카타르로 여행 떠나기"},{degrees:25,color:"#89cff0",text:"게임말 앞으로 10칸 이동"},{degrees:43,color:"#b5e9a1",text:"게임말 뒤로 15칸 이동"},{degrees:20,color:"#fe8c68",text:"베트남으로 여행 떠나기"},{degrees:42,color:"#ffe16f",text:"노르웨이로 여행 떠나기"},{degrees:20,color:"#fe8c68",text:"다음 기회에"},{degrees:12,color:"#89cff0",text:"게임알 1개, 도착지로 이동"},{degrees:60,color:"#b5e9a1",text:"영국으로 여행 떠나기"},{degrees:35,color:"#ffe16f",text:"불가리아로 여행 떠나기"},{degrees:33,color:"#fe8c68",text:"다음 기회에"}],rotationTimeRange:{min:3e3,max:4500},wheelRounds:{min:2,max:11},wheelRadius:240,strokeColor:16777215,strokeWidth:5},h={slices:[{degrees:25,color:"#ff0000",text:"WINNER",textColor:"#ffffff"},{degrees:45,color:"#2c7000",text:"히든카드 1장 가져오기",textColor:"#ffffff"},{degrees:45,color:"#ffdc0b",text:"무인도 탈출",textColor:"#000000"},{degrees:45,color:"#2c7000",text:"미션카드 섞기",textColor:"#ffffff"},{degrees:40,color:"#283a78",text:"싱가폴로 여행 떠나기",textColor:"#ffffff"},{degrees:45,color:"#2c7000",text:"꽝!",textColor:"#ffffff"},{degrees:45,color:"#283a78",text:"프랑스로 여행 떠나기",textColor:"#ffffff"},{degrees:70,color:"#ffdc0b",text:"게임말 1개 잡기",textColor:"#000000"}],wheelRadius:288};class g{constructor(e,t,i){this.scene=e,this.options=t,this.index=i,this.createWheel()}createWheel(){let e=this.scene.make.graphics({x:0,y:0,add:!1}),t=this.options.wheelRadius,i=100;this.wheelContainer=this.scene.add.container(this.scene.scale.width/2,this.scene.scale.height/2+i);let s=-90;this.options.slices.forEach(a=>{this.drawSlice(e,a,s,t),s+=a.degrees}),e.generateTexture(`wheel${this.index}`,(t+r.strokeWidth)*2,(t+r.strokeWidth)*2);let o=this.scene.add.sprite(0,0,`wheel${this.index}`);this.wheelContainer.add(o),this.index===0?this.addSliceTexts(s,t):(this.addSecondWheelTexts(s,t),this.wheelContainer.setDepth(-1))}drawSlice(e,t,i,s){let o=Phaser.Display.Color.ValueToColor(t.color);e.fillStyle(o.color,1),e.slice(s+r.strokeWidth,s+r.strokeWidth,s,Phaser.Math.DegToRad(i),Phaser.Math.DegToRad(i+t.degrees),!1),e.fillPath()}addSliceTexts(e,t){e=-90,this.options.slices.forEach(i=>{if(!i.text)return;let s=(t-100)*Math.cos(Phaser.Math.DegToRad(e+i.degrees/2)),o=(t-100)*Math.sin(Phaser.Math.DegToRad(e+i.degrees/2)),a=this.scene.add.text(s,o,i.text,{fontSize:"14px",fontFamily:"CookieRun",color:"#000000",fontWeight:"bold"});a.setOrigin(.6),a.setAngle(e+i.degrees/2+180),this.wheelContainer.add(a),e+=i.degrees})}addSecondWheelTexts(e,t){let i=t-22,s="20px CookieRun";this.options.slices.forEach(o=>{if(!o.text)return;let a=o.degrees,l=e+a/2,d=o.textColor||"#000000";this.drawPhaserCurvedText(o.text,i,l,a,s,d),e+=a})}drawPhaserCurvedText(e,t,i,s,o,a){const l=e.split(""),d=Phaser.Math.DegToRad(s),x=1,u=s>60?Math.max(.4,x-(s-60)/90*3):x;let c=l.length<7?Math.min(u,.8):u;const T=.35,B=Phaser.Math.DegToRad(1.5),S=Phaser.Math.DegToRad(10),p=Math.min(S,Math.max(B,d/l.length*c)),y=p*l.length;let f=Phaser.Math.DegToRad(i)-y/2.2+p/2;l.forEach(w=>{if(w===" "){f+=p*T;return}const C=t*Math.cos(f),W=t*Math.sin(f);let b=this.scene.add.text(C,W,w,{font:o,color:a});b.setOrigin(.5),b.setAngle(Phaser.Math.RadToDeg(f)+90),this.wheelContainer.add(b),f+=p})}}function m(){this.pin=this.add.sprite(this.scale.width/2,this.scale.height/2+100,"pin").setInteractive(),this.updatePinState(!0),this.pin.on("pointerdown",()=>{this.tweens.add({targets:this.pin,scale:.95,duration:100,yoyo:!0,ease:"Power1"}),[this.wheel1,this.wheel2].forEach(n=>{if(n.rotationTween){const e=n.wheelContainer.angle,t=n.direction||1;n.rotationTween.stop(),n.rotationTween=null;const i=Phaser.Math.Between(720,1080),s=e+t*i;this.tweens.add({targets:n.wheelContainer,angle:s,duration:4e3,ease:"Cubic.easeOut",onComplete:()=>{this.handleStop(n),n===this.wheel2&&(this.canSpin=!0,this.updateButtonState(!0))}})}})})}function R(){this.prizeBoxA=this.add.graphics(),this.prizeBoxA.fillStyle(16777215,1).fillRoundedRect(this.scale.width/2-300/2,this.scale.height/2-h.wheelRadius-90-60/2,300,60,10).lineStyle(0,12632256).strokeRoundedRect(this.scale.width/2-300/2,this.scale.height/2-h.wheelRadius-90-60/2,300,60,10),this.prizeTextA=this.add.text(this.scale.width/2,this.scale.height/2-h.wheelRadius-90,"A룰렛 결과",{font:"18px Arial",color:"#808080"}).setOrigin(.5),this.prizeBoxB=this.add.graphics(),this.prizeBoxB.fillStyle(16777215,1).fillRoundedRect(this.scale.width/2-300/2,this.scale.height/2-r.wheelRadius-90-60/2,300,60,10).lineStyle(0,12632256).strokeRoundedRect(this.scale.width/2-300/2,this.scale.height/2-r.wheelRadius-90-60/2,300,60,10),this.prizeTextB=this.add.text(this.scale.width/2,this.scale.height/2-r.wheelRadius-90,"B룰렛 결과",{font:"18px Arial",color:"#808080"}).setOrigin(.5);const d=this.scale.width/2-300/2+10,x=this.scale.width/2+300/2-10,u=(this.scale.height/2-h.wheelRadius-90+60/2+this.scale.height/2-r.wheelRadius-90-60/2)/2,c=this.add.graphics();c.lineStyle(.5,8421504),c.beginPath(),c.moveTo(d,u),c.lineTo(x,u),c.strokePath()}function I(){let n=40,e=100,t=this.textures.get("abutton").getSourceImage().width,i=this.textures.get("bbutton").getSourceImage().width,s=this.textures.get("abbutton").getSourceImage().width,o=t+i+s+n*2,a=(this.scale.width-o)/2;this.abutton=this.add.image(a+t/2,e,"activeButtonA").setOrigin(.5,0).setInteractive(),this.bbutton=this.add.image(this.abutton.x+t/2+i/2+n,e,"activeButtonB").setOrigin(.5,0).setInteractive(),this.abbutton=this.add.image(this.bbutton.x+i/2+s/2+n,e,"activeButtonAB").setOrigin(.5,0).setInteractive(),this.abutton.on("pointerdown",()=>{this.canSpin&&("speechSynthesis"in window&&window.speechSynthesis.cancel(),this.prizeTextA.setText(""),this.prizeTextB.setText(""),this.updateButtonState(!1),this.spinInfinite(this.wheel1,1))}),this.bbutton.on("pointerdown",()=>{this.canSpin&&("speechSynthesis"in window&&window.speechSynthesis.cancel(),this.prizeTextA.setText(""),this.prizeTextB.setText(""),this.updateButtonState(!1),this.spinInfinite(this.wheel2,-1))}),this.abbutton.on("pointerdown",()=>{this.canSpin&&("speechSynthesis"in window&&window.speechSynthesis.cancel(),this.prizeTextA.setText(""),this.prizeTextB.setText(""),this.updateButtonState(!1),this.spinInfinite(this.wheel1,1),this.spinInfinite(this.wheel2,-1))})}function P(n){let e=n.wheelContainer.angle%360;e<0&&(e+=360);let t=this.getPrizeIndex(e,n.options.slices),i=n.options.slices[t].text;n===this.wheel1?(this.prizeTextA.setText(i),this.readResult(i)):n===this.wheel2&&(this.prizeTextB.setText(i),this.readResult(i))}function v(n){if("speechSynthesis"in window){const e=new SpeechSynthesisUtterance(n);e.lang="ko-KR",e.pitch=1.3,e.rate=1,e.volume=1,window.speechSynthesis.speak(e)}else console.warn("이 브라우저는 SpeechSynthesis를 지원하지 않습니다.")}function A(n){n?this.pin.setTexture("unpin"):this.pin.setTexture("pin")}function E(n){n?(this.abutton.setInteractive().setTexture("activeButtonA"),this.bbutton.setInteractive().setTexture("activeButtonB"),this.abbutton.setInteractive().setTexture("activeButtonAB")):(this.abutton.disableInteractive().setTexture("abutton"),this.bbutton.disableInteractive().setTexture("bbutton"),this.abbutton.disableInteractive().setTexture("abbutton")),this.updatePinState(n)}function z(n,e){n.direction=e,n.rotationTween=this.tweens.add({targets:n.wheelContainer,angle:"+="+e*360,duration:600,ease:"Linear",repeat:-1})}function M(n,...e){this.canSpin&&(this.prizeTextA.setText(""),this.prizeTextB.setText(""),this.canSpin=!1,e.forEach((t,i)=>{let s=n[i];t.direction=s,t.rotationTween=this.tweens.add({targets:t.wheelContainer,angle:"+="+s*360,duration:900,ease:"Linear",repeat:-1})}))}function O(n,e){let t=0;for(let i=e.length-1;i>=0;i--)if(t+=e[i].degrees,t>n)return i;return 0}class k extends Phaser.Scene{constructor(){super("PlayGame"),this.currentTweens=[],this.canSpin=!0}preload(){this.load.image("pin","/assets/button.png"),this.load.image("unpin","/assets/unButton.png"),this.load.image("abutton","/assets/button_a.png"),this.load.image("bbutton","/assets/button_b.png"),this.load.image("abbutton","/assets/button_ab.png"),this.load.image("activeButtonA","/assets/active_button_a.png"),this.load.image("activeButtonB","/assets/active_button_b.png"),this.load.image("activeButtonAB","/assets/active_button_ab.png")}create(){this.wheel1=new g(this,r,0),this.wheel2=new g(this,h,1),m.call(this),R.call(this),I.call(this),document.getElementById("resetButton").addEventListener("click",()=>{this.showModal()}),document.getElementById("updateButton").addEventListener("click",()=>{this.updateWheelOptions()})}showModal(){const e=document.getElementById("innerWheelInputs"),t=document.getElementById("outerWheelInputs");e.innerHTML="",t.innerHTML="",r.slices.forEach((i,s)=>{const o=document.createElement("input");o.type="text",o.id=`innerWheelText${s}`,o.value=i.text,o.placeholder=`안쪽 룰렛 텍스트 ${s+1}`,e.appendChild(o)}),h.slices.forEach((i,s)=>{const o=document.createElement("input");o.type="text",o.id=`outerWheelText${s}`,o.value=i.text,o.placeholder=`바깥쪽 룰렛 텍스트 ${s+1}`,t.appendChild(o)}),document.getElementById("modal").style.display="block"}updateWheelOptions(){r.slices.forEach((e,t)=>{const i=document.getElementById(`innerWheelText${t}`);i&&(e.text=i.value)}),h.slices.forEach((e,t)=>{const i=document.getElementById(`outerWheelText${t}`);i&&(e.text=i.value)}),this.wheel1=new g(this,r,0),this.wheel2=new g(this,h,1),m.call(this),document.getElementById("modal").style.display="none"}handleStop(e){P.call(this,e),this.updateButtonState(!0)}readResult(e){v.call(this,e)}updatePinState(e){A.call(this,e)}updateButtonState(e){E.call(this,e)}spinInfinite(e,t){z.call(this,e,t)}spinWheel(e,...t){M.call(this,e,...t)}getPrizeIndex(e,t){return O.call(this,e,t)}}window.onload=function(){let n={scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,parent:"thegame",width:600,height:1400},backgroundColor:"#e9e9ea",scene:[k]};window.game=new Phaser.Game(n)};
